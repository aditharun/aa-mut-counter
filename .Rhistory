identical(orig, zenodo)
all.equal(orig, zenodo)
identical(as.double(8), as.integer(8), ignore.environment = TRUE)
identical(orig, zenodo, ignore.environment = TRUE)
zenodo <- "~/Downloads/aa-mut-counter/results/all-muts/counts-Cys.txt" %>% read_tsv()
zenodo <- "~/Downloads/aa-mut-counter/results/counts-Cys.txt" %>% read_tsv()
orig <- "~/Documents/GitHub/aa-mut-counter/results/counts-Cys.txt" %>% read_tsv()
zenodo
orig
all.equal(orig, zenodo)
"~/Downloads/test.csv" %>% read_csv()
"~/Downloads/test.csv" %>% read_csv()  %>% group_by(PATIENT_ID)
"~/Downloads/test.csv" %>% read_csv()
"~/Downloads/test.csv" %>% read_csv()  %>% group_by(PATIENT_ID)
"~/Downloads/test.csv" %>% read_csv()  %>% group_by(PATIENT_ID) %>% summarize(n = n())
"~/Downloads/test.csv" %>% read_csv()  %>% group_by(PATIENT_ID) %>% summarize(n = n()) %>% arrange(desc(n))
"~/Downloads/test.csv" %>% read_csv()  %>% group_by(PATIENT_ID) %>% summarize(n = n()) %>% arrange(desc(n))
"~/Downloads/aa-mut-counter/analyses/Cys/mut-rates.rds" %>% readRDS()
z <- "~/Downloads/aa-mut-counter/analyses/Cys/mut-rates.rds" %>% readRDS()
d <- "~/Documents/GitHub/aa-mut-counter/analyses/Cys/mut-rates.rds" %>% readRDS()
z
d
identical(z, d)
DMDEDUC3
z <- "~/Downloads/aa-mut-counter/analyses/Cys/mut-rates.rds" %>% readRDS()
d <- "~/Documents/GitHub/aa-mut-counter/analyses/Cys/mut-rates.rds" %>% readRDS()
z
identical(z,d)
r <- "~/Downloads/mut-rates-github.rds" %>% readRDS()
identical(r, d)
identical(r, z)
z2 <- "~/Downloads/mut-rates-zenodo.rds" %>% readRDS()
identical(z2, z)
identical(z2, d)
z2
zenodo <- "~/Downloads/aa-mut-counter/results/all-muts/df_mutfiles.csv" %>% read_tsv()
zenodo
zenodo
zenodo %>% filter(Variant_Classification == "missense_mutation")
zenodo %>% filter(Variant_Classification == "missense_mutation") %>% filter(CODE == 70537)
zenodo %>% filter(Variant_Classification == "missense_mutation") %>% group_by(Hugo_Symbol)
zenodo %>% filter(Variant_Classification == "missense_mutation") %>% group_by(Hugo_Symbol, HGVSp)
zenodo %>% filter(Variant_Classification == "missense_mutation") %>% group_by(Chromosome) %>% summarize(n = n())
setwd("~/Documents/GitHub/aa-mut-counter")
library(tidyverse)
datadir <- "results"
dfmut <- file.path(datadir, "all-muts", "df-mutfiles.csv") %>% read_tsv()
list.files()
dfmut <- file.path(datadir, "all-muts", "df_mutfiles.csv") %>% read_tsv()
dfmut
allcounts <- file.path(datadir, "all-muts", "all-counts-matrix.txt") %>% read_csv()
allcounts
allcounts <- file.path(datadir, "all-muts", "all-counts-matrix.txt") %>% read_tsv()
allcounts
allcounts %>% filter(Hugo_Su)
allcounts %>% filter(Hugo_Symbol == "Total")
total <- allcounts %>% filter(Hugo_Symbol == "Total")
list.files("results")
list.files("results", pattern = "*.txt")
list.files("results", pattern = "-*.txt")
list.files("results", pattern = "*.txt")
files <- list.files("results", pattern = "*.txt")
files <- list.files("results", pattern = "*.txt")
files
files[grepl(!"mutations", files)]
grepl(!"mutations", files)
grepl("mutations", files)
!grepl("mutations", files)
files[!grepl("mutations", files)]
aa_files <- files[!grepl("mutations", files)]
aa_files
aa_files[1] %>% read_tsv()
files <- list.files("results", pattern = "*.txt", full.names = TRUE)
files
aa_files <- files[!grepl("mutations", files)]
aa_files[1] %>% read_csv()
aa_files[1] %>% read_tsv()
aa_files[1] %>% read_tsv()
aa_files[1] %>% read_tsv()
test <- aa_files[1] %>% read_tsv()
test %>% mutate(aa = sub(".*p\\.", "", Hugo_Symbol)
)
test %>% mutate(aa = sub(".*p\\.", "", Hugo_Symbol)) %>% relocate(aa)
test %>% mutate(aa = sub(".*p\\.", "", Hugo_Symbol)) %>% mutate(aa = str_sub(aa, 1, 3)) %>% relocate(aa)
aa_files[1]
aa_files[1] %>% basename()
aa_files[1] %>% basename() %>% str_sub(., 1, -4)
aa_files[1] %>% basename() %>% str_sub(., 1, -5)
aa_files[1] %>% basename() %>% str_sub(., 1, -5) %>% str_sub(., 1, 5)
aa_files[1] %>% basename() %>% str_sub(., 1, -5) %>% str_sub(., 6, -1)
aa_files[1] %>% basename() %>% str_sub(., 1, -5) %>% str_sub(., 8, -1)
final_aa <- aa_files[1] %>% basename() %>% str_sub(., 1, -5) %>% str_sub(., 8, -1)
test <- aa_files[1] %>% read_tsv()
test <- test %>% mutate(init_aa = sub(".*p\\.", "", Hugo_Symbol)) %>% mutate(init_aa = str_sub(init_aa, 1, 3)) %>% mutate(final_aa = final_aa) %>% relocate(init_aa, final_aa) %>% select(-Hugo_Symbol)
test
test %>% group_by(init_aa, final_aa)
test %>% group_by(init_aa, final_aa) %>% summarise_all(sum())
test %>% group_by(init_aa, final_aa) %>% summarise_all(~sum())
test %>% group_by(init_aa, final_aa) %>% summarise_all(~sum
)
test %>% group_by(init_aa, final_aa) %>% summarise_all(sum)
test <- test %>% group_by(init_aa, final_aa) %>% summarise_all(sum)
test
aa_files
files <- list.files("results", pattern = "*.txt", full.names = TRUE)
aa_files <- files[!grepl("mutations", files)]
extract_transition_matrix <- function(filepath){
final_aa <- filepath %>% basename() %>% str_sub(., 1, -5) %>% str_sub(., 8, -1)
test <- filepath %>% read_tsv()
test <- test %>% mutate(init_aa = sub(".*p\\.", "", Hugo_Symbol)) %>% mutate(init_aa = str_sub(init_aa, 1, 3)) %>% mutate(final_aa = final_aa) %>% relocate(init_aa, final_aa) %>% select(-Hugo_Symbol)
test <- test %>% group_by(init_aa, final_aa) %>% summarise_all(sum)
test %>% ungroup()
}
df <- do.call(rbind, lapply(aa_files, function(x) extract_transition_matrix(x)) )
df
data <- lapply(aa_files, function(x) extract_transition_matrix(x))
total
colnames(total)
data[[1]]
setdiff(colnames(total)[-c(1:2)], data[[1]][-c(1:2)])
setdiff(colnames(total)[-c(1:2)], colnames(data[[1]])[-c(1:2)])
colnames(data[[1]])[-c(1:2)]
colnames(total)[-c(1:2)]
colnames(total)[-c(1)]
setdiff(colnames(total)[-c(1)], colnames(data[[1]])[-c(1:2)])
setdiff(colnames(data[[1]])[-c(1:2)], colnames(total)[-c(1)])
colnames(total)[-c(1)] %>% length()
colnames(data[[1]])[-c(1:2)] %>% length()
setdiff(colnames(total)[-c(1)], colnames(data[[1]])[-c(1:2)])
data[[1]]
setdiff(colnames(total)[-c(1)], colnames(data[[1]])[-c(1:2)])
cols_to_add <- setdiff(colnames(total)[-c(1)], colnames(data[[1]])[-c(1:2)])
test[, cols_to_add] <- 0
test
test %>% relocate("97183")
cols_to_add <- c("971844", "971855")
test[, cols_to_add] <- 0
test %>% relocate(cols_to_add)
extract_transition_matrix <- function(filepath, total_cols){
final_aa <- filepath %>% basename() %>% str_sub(., 1, -5) %>% str_sub(., 8, -1)
test <- filepath %>% read_tsv()
test <- test %>% mutate(init_aa = sub(".*p\\.", "", Hugo_Symbol)) %>% mutate(init_aa = str_sub(init_aa, 1, 3)) %>% mutate(final_aa = final_aa) %>% relocate(init_aa, final_aa) %>% select(-Hugo_Symbol)
test <- test %>% group_by(init_aa, final_aa) %>% summarise_all(sum)
test <- test %>% ungroup()
cols_to_add <- setdiff(total_cols, colnames(test)[-c(1:2)])
if (!identical(cols_to_add, character(0))){
test[,cols_to_add] <- 0
}
test
}
data <- lapply(aa_files, function(x) extract_transition_matrix(x, colnames(total)[-1]))
data
df
df <- do.call(rbind,  data) %>% as_tibble()
df
df <- df %>% select(-All)
df
df %>% pivot_longer(-c(init_aa, final_aa))
df %>% pivot_longer(-c(init_aa, final_aa)) %>% magrittr::set_colnames(c("init_aa", "final_aa", "rosetta", "count"))
df.l <- df %>% pivot_longer(-c(init_aa, final_aa)) %>% magrittr::set_colnames(c("init_aa", "final_aa", "rosetta", "count"))
df.l
total
total %>% select(-c(Hugo_Symbol, All))
total %>% select(-All) %>% pivot_longer(-Hugo_Symbol)
total %>% select(-All) %>% pivot_longer(-Hugo_Symbol) %>% select(-Hugo_Symbol) %>% magrittr::set_colnames(c("rosetta", "total"))
total.l <- total %>% select(-All) %>% pivot_longer(-Hugo_Symbol) %>% select(-Hugo_Symbol) %>% magrittr::set_colnames(c("rosetta", "total"))
total.kl
total.l
df.l
df.l %>% left_join(total.l)
df.l %>% left_join(total.l) %>% mutate(rate = count / total) %>% mutate(pct = round(rate*100, 2))
rate.df <- df.l %>% left_join(total.l) %>% mutate(rate = count / total) %>% mutate(pct = round(rate*100, 2))
rate.df
rate.df %>% filte(rosetta == "70317")
rate.df %>% filter(rosetta == "70317")
ggplot(data, aes(x = init_aa, y = final_aa, fill = pct)) +  # Map aesthetics
geom_tile() +  # Create tiles
scale_fill_gradient(low = "lightgrey", high = "red") +  # Color gradient
labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Percentage") +  # Labels
theme_minimal() +  # Minimal theme
theme(axis.text.x = element_text(angle = 45, hjust = 1))
rate.df %>% filter(rosetta == "70317") %>% ggplot(., aes(x = init_aa, y = final_aa, fill = pct)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red") + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Percentage") +  theme_minimal() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
rate.df %>% filter(rosetta == "70317") %>% ggplot(., aes(x = init_aa, y = final_aa, fill = pct)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey") + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Percentage") +  theme_minimal() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
amino_acids
amino_acids()
install.packages("agvgd")
agvgd::amino_acids()
agvgd::amino_acids("three_letter")
expand.grid(init_aa = agvgd::amino_acids("three_letter"), final_aa = agvgd::amino_acids("three_letter"))
expand.grid(init_aa = agvgd::amino_acids("three_letter"), final_aa = agvgd::amino_acids("three_letter")) %>% as_tibble()
rate.df %>% filter(rosetta == "70317")
total_grid <- expand.grid(init_aa = agvgd::amino_acids("three_letter"), final_aa = agvgd::amino_acids("three_letter")) %>% as_tibble()
cancer.df <- rate.df %>% filter(rosetta == "70317")
total_grid %>% left_join(cancer.df)
total_grid %>% left_join(cancer.df) %>% filter(is.na(rate))
total_grid %>% left_join(cancer.df) %>% mutate(pct = ifelse(is.na(pct), 0, pct))
mat <- total_grid %>% left_join(cancer.df) %>% mutate(pct = ifelse(is.na(pct), 0, pct))
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = pct)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey") + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Percentage") +  theme_minimal() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
rate.df
test
df <- do.call(rbind,  data) %>% as_tibble()
df <- df %>% select(-All)
df.l <- df %>% pivot_longer(-c(init_aa, final_aa)) %>% magrittr::set_colnames(c("init_aa", "final_aa", "rosetta", "count"))
total.l <- total %>% select(-All) %>% pivot_longer(-Hugo_Symbol) %>% select(-Hugo_Symbol) %>% magrittr::set_colnames(c("rosetta", "total"))
rate.df <- df.l %>% left_join(total.l) %>% mutate(rate = count / total)
#70317 is breast cancer
total_grid <- expand.grid(init_aa = agvgd::amino_acids("three_letter"), final_aa = agvgd::amino_acids("three_letter")) %>% as_tibble()
cancer.df <- rate.df %>% filter(rosetta == "70317")
total_grid %>% left_join(cancer.df)
mat <- total_grid %>% left_join(cancer.df) %>% mutate(rate = ifelse(is.na(rate), 0, rate))
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey") + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
agvgd::amino_acids("three_letter")
agvgd::amino_acids("three_letter") %>% sort()
agvgd::amino_acids("three_letter") %>% sort() %>% rev()
mat <- total_grid %>% left_join(cancer.df) %>% mutate(rate = ifelse(is.na(rate), 0, rate))
mat$init_aa <- factor(mat$init_aa, levels = agvgd::amino_acids("three_letter") %>% sort())
mat$final_aa <- factor(mat$final_aa, levels = agvgd::amino_acids("three_letter") %>% sort() %>% rev())
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey") + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey") + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(axis.text.x = element_text(angle = 45, hjust = 1), panel.grid = element_blank())
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey") + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(axis.text.x = element_text(angle = 45, hjust = 1), panel.grid = element_blank(), axis.ticks = element_line(color = "grey70"))
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey") + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank(), axis.ticks = element_line(color = "grey70"))
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey") + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank())
total_grid <- expand.grid(init_aa = agvgd::amino_acids("three_letter"), final_aa = agvgd::amino_acids("three_letter")) %>% as_tibble()
cancer.df <- rate.df %>% filter(rosetta == "70327")
total_grid %>% left_join(cancer.df)
mat <- total_grid %>% left_join(cancer.df) %>% mutate(rate = ifelse(is.na(rate), 0, rate))
mat$init_aa <- factor(mat$init_aa, levels = agvgd::amino_acids("three_letter") %>% sort())
mat$final_aa <- factor(mat$final_aa, levels = agvgd::amino_acids("three_letter") %>% sort() %>% rev())
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey") + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank())
data
dfmut
dfmut %>% filter(grepl("Cys", HGVSp)))
dfmut %>% filter(grepl("Cys", HGVSp))
dfmut %>% filter(grepl("Cys", HGVSp)) %>% filter(grepl("p.Cys", HGVSp))
dfmut %>% filter(grepl("Cys$", HGVSp)) %>% filter(grepl("p.Cys", HGVSp))
dfmut %>% filter(grepl("Cys$", HGVSp))
dfmut_cys <- dfmut %>% filter(grepl("Cys$", HGVSp))
dfmut_cys
dfmut_cys %>% filter("p.Cys", HGVSp)
dfmut_cys %>% filter(grepl("p.Cys", HGVSp))
dfmut_cys %>% filter(grepl("p.Cys*", HGVSp))
dfmut_cys %>% filter(grepl("p.Cys*Cys$", HGVSp))
dfmut_cys %>% filter(grepl("p.Cys*", HGVSp))
dfmut_cys %>% filter(grepl("p.Cys*", HGVSp)) %>% slice(2)
dfmut_cys %>% filter(grepl("p.Cys*", HGVSp)) %>% slice(2) %>% pull(6)
dfmut_cys %>% filter(grepl("p.Cys*", HGVSp)) %>% slice(2) %>% pull(5)
pattern <- "^p\\.Cys.*Cys$"
dfmut %>% filter(grepl(pattern, HGVSp))
data
dfmut %>% filter(grepl(pattern, HGVSp))
data[[5]]
dfmut$Variant_Classification %>% unique()
total_grid <- expand.grid(init_aa = agvgd::amino_acids("three_letter"), final_aa = agvgd::amino_acids("three_letter")) %>% as_tibble()
cancer.df <- rate.df %>% filter(rosetta == "70117")
total_grid %>% left_join(cancer.df)
mat <- total_grid %>% left_join(cancer.df) %>% mutate(rate = ifelse(is.na(rate), 0, rate))
mat$init_aa <- factor(mat$init_aa, levels = agvgd::amino_acids("three_letter") %>% sort())
mat$final_aa <- factor(mat$final_aa, levels = agvgd::amino_acids("three_letter") %>% sort() %>% rev())
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey") + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank())
total_grid <- expand.grid(init_aa = agvgd::amino_acids("three_letter"), final_aa = agvgd::amino_acids("three_letter")) %>% as_tibble()
cancer.df <- rate.df %>% filter(rosetta == "70317")
total_grid %>% left_join(cancer.df)
mat <- total_grid %>% left_join(cancer.df) %>% mutate(rate = ifelse(is.na(rate), 0, rate))
mat$init_aa <- factor(mat$init_aa, levels = agvgd::amino_acids("three_letter") %>% sort())
mat$final_aa <- factor(mat$final_aa, levels = agvgd::amino_acids("three_letter") %>% sort() %>% rev())
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey") + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank())
total_grid <- expand.grid(init_aa = agvgd::amino_acids("three_letter"), final_aa = agvgd::amino_acids("three_letter")) %>% as_tibble()
cancer.df <- rate.df %>% filter(rosetta == "70367")
total_grid %>% left_join(cancer.df)
mat <- total_grid %>% left_join(cancer.df) %>% mutate(rate = ifelse(is.na(rate), 0, rate))
mat$init_aa <- factor(mat$init_aa, levels = agvgd::amino_acids("three_letter") %>% sort())
mat$final_aa <- factor(mat$final_aa, levels = agvgd::amino_acids("three_letter") %>% sort() %>% rev())
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey") + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank())
total_grid <- expand.grid(init_aa = agvgd::amino_acids("three_letter"), final_aa = agvgd::amino_acids("three_letter")) %>% as_tibble()
cancer.df <- rate.df %>% filter(rosetta == "70387")
total_grid %>% left_join(cancer.df)
mat <- total_grid %>% left_join(cancer.df) %>% mutate(rate = ifelse(is.na(rate), 0, rate))
mat$init_aa <- factor(mat$init_aa, levels = agvgd::amino_acids("three_letter") %>% sort())
mat$final_aa <- factor(mat$final_aa, levels = agvgd::amino_acids("three_letter") %>% sort() %>% rev())
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey") + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank())
gi_tumor_codes <- c("70367", "70387", "70187", "70347", "70337", "70377", "70217", "81603")
gi_tumor_names <- c("Colorectal Adenocarcinoma", "Pancreatic Adenocarcinoma", "Hepatocellular Carcinoma", "Gastric Adenocarcinoma", "Esophageal Adenocarcinoma", "Gallbladder Cancer", "Esophageal Squamous\nCell Carcinoma", "Cholangiocarcinoma")
gi_df <- data.frame(rosetta = gi_tumor_codes, names = gi_tumor_names) %>% as_tibble()
gi_df
x <- 1
code <- gi_df$rosetta[x]
cancer__name <- gi_df$names[x]
code
code <- gi_df$rosetta[x]
cancer__name <- gi_df$names[x]
total_grid <- expand.grid(init_aa = agvgd::amino_acids("three_letter"), final_aa = agvgd::amino_acids("three_letter")) %>% as_tibble()
cancer.df <- rate.df %>% filter(rosetta == code)
mat <- total_grid %>% left_join(cancer.df) %>% mutate(rate = ifelse(is.na(rate), 0, rate))
mat$init_aa <- factor(mat$init_aa, levels = agvgd::amino_acids("three_letter") %>% sort())
mat$final_aa <- factor(mat$final_aa, levels = agvgd::amino_acids("three_letter") %>% sort() %>% rev())
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey") + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank())
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 5)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank())
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 6)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank())
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 8)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank())
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 6)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank())
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 6)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank())
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 6)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank()) + ggtitle(cancer_name) + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.text = element_text(size = 8), axis.title = element_text(size = 10))
cancer__name <- gi_df$names[x]
total_grid <- expand.grid(init_aa = agvgd::amino_acids("three_letter"), final_aa = agvgd::amino_acids("three_letter")) %>% as_tibble()
cancer.df <- rate.df %>% filter(rosetta == code)
mat <- total_grid %>% left_join(cancer.df) %>% mutate(rate = ifelse(is.na(rate), 0, rate))
mat$init_aa <- factor(mat$init_aa, levels = agvgd::amino_acids("three_letter") %>% sort())
mat$final_aa <- factor(mat$final_aa, levels = agvgd::amino_acids("three_letter") %>% sort() %>% rev())
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 6)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank()) + ggtitle(cancer_name) + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.text = element_text(size = 8), axis.title = element_text(size = 10))
cancer_name <- gi_df$names[x]
total_grid <- expand.grid(init_aa = agvgd::amino_acids("three_letter"), final_aa = agvgd::amino_acids("three_letter")) %>% as_tibble()
cancer.df <- rate.df %>% filter(rosetta == code)
mat <- total_grid %>% left_join(cancer.df) %>% mutate(rate = ifelse(is.na(rate), 0, rate))
mat$init_aa <- factor(mat$init_aa, levels = agvgd::amino_acids("three_letter") %>% sort())
mat$final_aa <- factor(mat$final_aa, levels = agvgd::amino_acids("three_letter") %>% sort() %>% rev())
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 6)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank()) + ggtitle(cancer_name) + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.text = element_text(size = 8), axis.title = element_text(size = 10))
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 6)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank()) + ggtitle(cancer_name) + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.text = element_text(size = 8), axis.title = element_text(size = 9))
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 6)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank()) + ggtitle(cancer_name) + theme(plot.title = element_text(size = 15, hjust = 0.5), axis.text = element_text(size = 8), axis.title = element_text(size = 9), legend.title = element_text(size = 9))
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 6)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank()) + ggtitle(cancer_name) + theme(plot.title = element_text(size = 15, hjust = 0.5), axis.text = element_text(size = 8), axis.title = element_text(size = 9), legend.title = element_text(size = 10), legend.text = element_text(size = 8))
create_heatmap <- function(rate.df, gi_df, index){
code <- gi_df$rosetta[index]
cancer_name <- gi_df$names[index]
total_grid <- expand.grid(init_aa = agvgd::amino_acids("three_letter"), final_aa = agvgd::amino_acids("three_letter")) %>% as_tibble()
cancer.df <- rate.df %>% filter(rosetta == code)
mat <- total_grid %>% left_join(cancer.df) %>% mutate(rate = ifelse(is.na(rate), 0, rate))
mat$init_aa <- factor(mat$init_aa, levels = agvgd::amino_acids("three_letter") %>% sort())
mat$final_aa <- factor(mat$final_aa, levels = agvgd::amino_acids("three_letter") %>% sort() %>% rev())
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 6)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank()) + ggtitle(cancer_name) + theme(plot.title = element_text(size = 15, hjust = 0.5), axis.text = element_text(size = 8), axis.title = element_text(size = 9), legend.title = element_text(size = 10), legend.text = element_text(size = 8))
}
plt.list <- lapply(1:nrow(gi_df), function(x) create_heatmap(rate.df, gi_df, x))
plt.list
plt.list[2]
plt.list[[1]]
plt.list[[2]]
plt.list[[3]]
plt.list[[4]]
plt.list[[5]]
plt.list[[6]]
cowplot::plot_grid(plotlist = plt.list, nrow = 2, ncol = 4)
create_heatmap <- function(rate.df, gi_df, index){
code <- gi_df$rosetta[index]
cancer_name <- gi_df$names[index]
total_grid <- expand.grid(init_aa = agvgd::amino_acids("three_letter"), final_aa = agvgd::amino_acids("three_letter")) %>% as_tibble()
cancer.df <- rate.df %>% filter(rosetta == code)
mat <- total_grid %>% left_join(cancer.df) %>% mutate(rate = ifelse(is.na(rate), 0, rate))
mat$init_aa <- factor(mat$init_aa, levels = agvgd::amino_acids("three_letter") %>% sort())
mat$final_aa <- factor(mat$final_aa, levels = agvgd::amino_acids("three_letter") %>% sort() %>% rev())
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 6)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank()) + ggtitle(cancer_name) + theme(plot.title = element_text(size = 15, hjust = 0.5), axis.text = element_text(size = 8), axis.title = element_text(size = 9), legend.title = element_text(size = 10), legend.text = element_text(size = 8), legend.key.size = unit(1, "cm"))
}
plt.list <- lapply(1:nrow(gi_df), function(x) create_heatmap(rate.df, gi_df, x))
plt.list[[1]]
cowplot::plot_grid(plotlist = plt.list, nrow = 2, ncol = 4)
create_heatmap <- function(rate.df, gi_df, index){
code <- gi_df$rosetta[index]
cancer_name <- gi_df$names[index]
total_grid <- expand.grid(init_aa = agvgd::amino_acids("three_letter"), final_aa = agvgd::amino_acids("three_letter")) %>% as_tibble()
cancer.df <- rate.df %>% filter(rosetta == code)
mat <- total_grid %>% left_join(cancer.df) %>% mutate(rate = ifelse(is.na(rate), 0, rate))
mat$init_aa <- factor(mat$init_aa, levels = agvgd::amino_acids("three_letter") %>% sort())
mat$final_aa <- factor(mat$final_aa, levels = agvgd::amino_acids("three_letter") %>% sort() %>% rev())
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 6)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank()) + ggtitle(cancer_name) + theme(plot.title = element_text(size = 15, hjust = 0.5), axis.text = element_text(size = 8), axis.title = element_text(size = 9), legend.title = element_text(size = 10), legend.text = element_text(size = 8), legend.key.size = unit(0.3, "cm"))
}
plt.list <- lapply(1:nrow(gi_df), function(x) create_heatmap(rate.df, gi_df, x))
cowplot::plot_grid(plotlist = plt.list, nrow = 2, ncol = 4)
create_heatmap <- function(rate.df, gi_df, index){
code <- gi_df$rosetta[index]
cancer_name <- gi_df$names[index]
total_grid <- expand.grid(init_aa = agvgd::amino_acids("three_letter"), final_aa = agvgd::amino_acids("three_letter")) %>% as_tibble()
cancer.df <- rate.df %>% filter(rosetta == code)
mat <- total_grid %>% left_join(cancer.df) %>% mutate(rate = ifelse(is.na(rate), 0, rate))
mat$init_aa <- factor(mat$init_aa, levels = agvgd::amino_acids("three_letter") %>% sort())
mat$final_aa <- factor(mat$final_aa, levels = agvgd::amino_acids("three_letter") %>% sort() %>% rev())
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 6)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank()) + ggtitle(cancer_name) + theme(plot.title = element_text(size = 15, hjust = 0.5), axis.text = element_text(size = 8), axis.title = element_text(size = 9), legend.title = element_text(size = 10), legend.text = element_text(size = 8), legend.key.size = unit(0.25, "cm"))
}
plt.list <- lapply(1:nrow(gi_df), function(x) create_heatmap(rate.df, gi_df, x))
cowplot::plot_grid(plotlist = plt.list, nrow = 2, ncol = 4) %>% ggsave(filename = "~/Downloads/mutation-landscape-of-gi-tumors.pdf", plot = ., units = "in", height = 8, width = 27, device = cairo_pdf)
gi_tumor_codes <- c("70367", "70387", "70187", "70347", "70337", "70377", "70217", "81603")
gi_tumor_names <- c("Colorectal Adenocarcinoma", "Pancreatic Adenocarcinoma", "Hepatocellular Carcinoma", "Gastric Adenocarcinoma", "Esophageal Adenocarcinoma", "Gallbladder Cancer", "Esophageal Squamous Cell Carcinoma", "Cholangiocarcinoma")
gi_df <- data.frame(rosetta = gi_tumor_codes, names = gi_tumor_names) %>% as_tibble()
create_heatmap <- function(rate.df, gi_df, index){
code <- gi_df$rosetta[index]
cancer_name <- gi_df$names[index]
total_grid <- expand.grid(init_aa = agvgd::amino_acids("three_letter"), final_aa = agvgd::amino_acids("three_letter")) %>% as_tibble()
cancer.df <- rate.df %>% filter(rosetta == code)
mat <- total_grid %>% left_join(cancer.df) %>% mutate(rate = ifelse(is.na(rate), 0, rate))
mat$init_aa <- factor(mat$init_aa, levels = agvgd::amino_acids("three_letter") %>% sort())
mat$final_aa <- factor(mat$final_aa, levels = agvgd::amino_acids("three_letter") %>% sort() %>% rev())
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 6)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank()) + ggtitle(cancer_name) + theme(plot.title = element_text(size = 15, hjust = 0.5), axis.text = element_text(size = 8), axis.title = element_text(size = 9), legend.title = element_text(size = 10), legend.text = element_text(size = 8), legend.key.size = unit(0.25, "cm"))
}
plt.list <- lapply(1:nrow(gi_df), function(x) create_heatmap(rate.df, gi_df, x))
cowplot::plot_grid(plotlist = plt.list, nrow = 2, ncol = 4) %>% ggsave(filename = "~/Downloads/mutation-landscape-of-gi-tumors.pdf", plot = ., units = "in", height = 8, width = 27, device = cairo_pdf)
cowplot::plot_grid(plotlist = plt.list, nrow = 2, ncol = 4) %>% ggsave(filename = "~/Downloads/mutation-landscape-of-gi-tumors.pdf", plot = ., units = "in", height = 6, width = 24, device = cairo_pdf)
cowplot::plot_grid(plotlist = plt.list, nrow = 2, ncol = 4) %>% ggsave(filename = "~/Downloads/mutation-landscape-of-gi-tumors.pdf", plot = ., units = "in", height = 8, width = 24, device = cairo_pdf)
gi_df
levels_tumor_names <- c("Esophageal Adenocarcinoma", "Esophageal Squamous Cell Carcinoma", "Gastric Adenocarcinoma", "Gallbladder Cancer", "Cholangiocarcinoma", "Hepatocellular Carcinoma", "Pancreatic Adenocarcinoma", "Colorectal Adenocarcinoma")
gi_df <- gi_df[match(levels_tumor_names, gi_df$gi_tumor_names), ]
gi_tumor_codes <- c("70367", "70387", "70187", "70347", "70337", "70377", "70217", "81603")
gi_tumor_names <- c("Colorectal Adenocarcinoma", "Pancreatic Adenocarcinoma", "Hepatocellular Carcinoma", "Gastric Adenocarcinoma", "Esophageal Adenocarcinoma", "Gallbladder Cancer", "Esophageal Squamous Cell Carcinoma", "Cholangiocarcinoma")
levels_tumor_names <- c("Esophageal Adenocarcinoma", "Esophageal Squamous Cell Carcinoma", "Gastric Adenocarcinoma", "Gallbladder Cancer", "Cholangiocarcinoma", "Hepatocellular Carcinoma", "Pancreatic Adenocarcinoma", "Colorectal Adenocarcinoma")
gi_df <- data.frame(rosetta = gi_tumor_codes, names = gi_tumor_names) %>% as_tibble()
gi_df <- gi_df[match(levels_tumor_names, gi_df$names), ]
gi_df
create_heatmap <- function(rate.df, gi_df, index){
code <- gi_df$rosetta[index]
cancer_name <- gi_df$names[index]
total_grid <- expand.grid(init_aa = agvgd::amino_acids("three_letter"), final_aa = agvgd::amino_acids("three_letter")) %>% as_tibble()
cancer.df <- rate.df %>% filter(rosetta == code)
mat <- total_grid %>% left_join(cancer.df) %>% mutate(rate = ifelse(is.na(rate), 0, rate))
mat$init_aa <- factor(mat$init_aa, levels = agvgd::amino_acids("three_letter") %>% sort())
mat$final_aa <- factor(mat$final_aa, levels = agvgd::amino_acids("three_letter") %>% sort() %>% rev())
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 6)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank()) + ggtitle(cancer_name) + theme(plot.title = element_text(size = 15, hjust = 0.5), axis.text = element_text(size = 8), axis.title = element_text(size = 9), legend.title = element_text(size = 10), legend.text = element_text(size = 8), legend.key.size = unit(0.25, "cm"))
}
plt.list <- lapply(1:nrow(gi_df), function(x) create_heatmap(rate.df, gi_df, x))
cowplot::plot_grid(plotlist = plt.list, nrow = 2, ncol = 4) %>% ggsave(filename = "~/Downloads/mutation-landscape-of-gi-tumors.pdf", plot = ., units = "in", height = 6, width = 24, device = cairo_pdf)
cowplot::plot_grid(plotlist = plt.list, nrow = 2, ncol = 4) %>% ggsave(filename = "~/Downloads/mutation-landscape-of-gi-tumors.pdf", plot = ., units = "in", height = 6, width = 22, device = cairo_pdf)
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 6)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank()) + ggtitle(cancer_name) + theme(plot.title = element_text(size = 15, hjust = 0.5), axis.text = element_text(size = 8), axis.title = element_text(size = 9), legend.title = element_text(size = 10), legend.text = element_text(size = 8), legend.key.size = unit(0.25, "cm"))
mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 6)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank()) + ggtitle(cancer_name) + theme(plot.title = element_text(size = 15, hjust = 0.5), axis.text = element_text(size = 8), axis.title = element_text(size = 9), legend.title = element_text(size = 10), legend.text = element_text(size = 8), legend.key.size = unit(0.25, "cm")) + theme(legend.position = "bottom")
create_heatmap <- function(rate.df, gi_df, index){
code <- gi_df$rosetta[index]
cancer_name <- gi_df$names[index]
total_grid <- expand.grid(init_aa = agvgd::amino_acids("three_letter"), final_aa = agvgd::amino_acids("three_letter")) %>% as_tibble()
cancer.df <- rate.df %>% filter(rosetta == code)
mat <- total_grid %>% left_join(cancer.df) %>% mutate(rate = ifelse(is.na(rate), 0, rate))
mat$init_aa <- factor(mat$init_aa, levels = agvgd::amino_acids("three_letter") %>% sort())
mat$final_aa <- factor(mat$final_aa, levels = agvgd::amino_acids("three_letter") %>% sort() %>% rev())
plt <- mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 6)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank()) + ggtitle(cancer_name) + theme(plot.title = element_text(size = 15, hjust = 0.5), axis.text = element_text(size = 8), axis.title = element_text(size = 9), legend.title = element_text(size = 10), legend.text = element_text(size = 8), legend.key.size = unit(0.25, "cm"))
if (!index %in% c(1, 5)){
plt <- plt + theme(legend.title = element_blank())
}
plt
}
plt.list <- lapply(1:nrow(gi_df), function(x) create_heatmap(rate.df, gi_df, x))
cowplot::plot_grid(plotlist = plt.list, nrow = 2, ncol = 4) %>% ggsave(filename = "~/Downloads/mutation-landscape-of-gi-tumors.pdf", plot = ., units = "in", height = 6, width = 22, device = cairo_pdf)
create_heatmap <- function(rate.df, gi_df, index){
code <- gi_df$rosetta[index]
cancer_name <- gi_df$names[index]
total_grid <- expand.grid(init_aa = agvgd::amino_acids("three_letter"), final_aa = agvgd::amino_acids("three_letter")) %>% as_tibble()
cancer.df <- rate.df %>% filter(rosetta == code)
mat <- total_grid %>% left_join(cancer.df) %>% mutate(rate = ifelse(is.na(rate), 0, rate))
mat$init_aa <- factor(mat$init_aa, levels = agvgd::amino_acids("three_letter") %>% sort())
mat$final_aa <- factor(mat$final_aa, levels = agvgd::amino_acids("three_letter") %>% sort() %>% rev())
plt <- mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 6)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank()) + ggtitle(cancer_name) + theme(plot.title = element_text(size = 15, hjust = 0.5), axis.text = element_text(size = 6), axis.title = element_text(size = 9), legend.title = element_text(size = 10), legend.text = element_text(size = 8), legend.key.size = unit(0.25, "cm"))
if (!index %in% c(1, 5)){
plt <- plt + theme(legend.title = element_blank())
}
plt
}
plt.list <- lapply(1:nrow(gi_df), function(x) create_heatmap(rate.df, gi_df, x))
cowplot::plot_grid(plotlist = plt.list, nrow = 2, ncol = 4) %>% ggsave(filename = "~/Downloads/mutation-landscape-of-gi-tumors.pdf", plot = ., units = "in", height = 6, width = 22, device = cairo_pdf)
cowplot::plot_grid(plotlist = plt.list, nrow = 2, ncol = 4) %>% ggsave(filename = "~/Downloads/mutation-landscape-of-gi-tumors.pdf", plot = ., units = "in", height = 6, width = 21, device = cairo_pdf)
create_heatmap <- function(rate.df, gi_df, index){
code <- gi_df$rosetta[index]
cancer_name <- gi_df$names[index]
total_grid <- expand.grid(init_aa = agvgd::amino_acids("three_letter"), final_aa = agvgd::amino_acids("three_letter")) %>% as_tibble()
cancer.df <- rate.df %>% filter(rosetta == code)
mat <- total_grid %>% left_join(cancer.df) %>% mutate(rate = ifelse(is.na(rate), 0, rate))
mat$init_aa <- factor(mat$init_aa, levels = agvgd::amino_acids("three_letter") %>% sort())
mat$final_aa <- factor(mat$final_aa, levels = agvgd::amino_acids("three_letter") %>% sort() %>% rev())
plt <- mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 6)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank()) + ggtitle(cancer_name) + theme(plot.title = element_text(size = 12, hjust = 0.5), axis.text = element_text(size = 6), axis.title = element_text(size = 9), legend.title = element_text(size = 10), legend.text = element_text(size = 8), legend.key.size = unit(0.25, "cm"))
if (!index %in% c(1, 5)){
plt <- plt + theme(legend.title = element_blank())
}
plt
}
plt.list <- lapply(1:nrow(gi_df), function(x) create_heatmap(rate.df, gi_df, x))
cowplot::plot_grid(plotlist = plt.list, nrow = 2, ncol = 4) %>% ggsave(filename = "~/Downloads/mutation-landscape-of-gi-tumors.pdf", plot = ., units = "in", height = 6, width = 20, device = cairo_pdf)
total_grid <- expand.grid(init_aa = agvgd::amino_acids("three_letter"), final_aa = agvgd::amino_acids("three_letter")) %>% as_tibble()
cowplot::plot_grid(plotlist = plt.list, nrow = 4, ncol = 2) %>% ggsave(filename = "~/Downloads/mutation-landscape-of-gi-tumors.pdf", plot = ., units = "in", height = 20, width = 7, device = cairo_pdf)
cowplot::plot_grid(plotlist = plt.list, nrow = 4, ncol = 2) %>% ggsave(filename = "~/Downloads/mutation-landscape-of-gi-tumors.pdf", plot = ., units = "in", height = 18, width = 10, device = cairo_pdf)
cowplot::plot_grid(plotlist = plt.list, nrow = 2, ncol = 4) %>% ggsave(filename = "~/Downloads/mutation-landscape-of-gi-tumors.pdf", plot = ., units = "in", height = 6, width = 20, device = cairo_pdf)
cowplot::plot_grid(plotlist = plt.list, nrow = 2, ncol = 4) %>% ggsave(filename = "~/Downloads/mutation-landscape-of-gi-tumors.pdf", plot = ., units = "in", height = 6, width = 20, device = cairo_pdf, rel_widths = c(1.15, 1, 1, 1))
cowplot::plot_grid(plotlist = plt.list, nrow = 2, ncol = 4, rel_widths = c(1.1, 1, 1, 1)) %>% ggsave(filename = "~/Downloads/mutation-landscape-of-gi-tumors.pdf", plot = ., units = "in", height = 6, width = 20, device = cairo_pdf, rel_widths = c(1.2, 1, 1, 1))
cowplot::plot_grid(plotlist = plt.list, nrow = 2, ncol = 4, rel_widths = c(1.1, 1, 1, 1)) %>% ggsave(filename = "~/Downloads/mutation-landscape-of-gi-tumors.pdf", plot = ., units = "in", height = 6, width = 20, device = cairo_pdf)
cowplot::plot_grid(plotlist = plt.list, nrow = 2, ncol = 4, rel_widths = c(1.08, 1, 1, 1)) %>% ggsave(filename = "~/Downloads/mutation-landscape-of-gi-tumors.pdf", plot = ., units = "in", height = 6, width = 20, device = cairo_pdf)
gi_df
create_heatmap <- function(rate.df, gi_df, index){
code <- gi_df$rosetta[index]
cancer_name <- gi_df$names[index]
total_grid <- expand.grid(init_aa = agvgd::amino_acids("one_letter"), final_aa = agvgd::amino_acids("one_letter")) %>% as_tibble()
cancer.df <- rate.df %>% filter(rosetta == code)
mat <- total_grid %>% left_join(cancer.df) %>% mutate(rate = ifelse(is.na(rate), 0, rate))
mat$init_aa <- factor(mat$init_aa, levels = agvgd::amino_acids("one_letter") %>% sort())
mat$final_aa <- factor(mat$final_aa, levels = agvgd::amino_acids("one_letter") %>% sort() %>% rev())
plt <- mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 6)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank()) + ggtitle(cancer_name) + theme(plot.title = element_text(size = 12, hjust = 0.5), axis.text = element_text(size = 6), axis.title = element_text(size = 9), legend.title = element_text(size = 10), legend.text = element_text(size = 8), legend.key.size = unit(0.25, "cm"))
if (!index %in% c(1, 5)){
plt <- plt + theme(legend.title = element_blank())
}
plt
}
plt.list <- lapply(1:nrow(gi_df), function(x) create_heatmap(rate.df, gi_df, x))
cowplot::plot_grid(plotlist = plt.list, nrow = 2, ncol = 4, rel_widths = c(1.08, 1, 1, 1)) %>% ggsave(filename = "~/Downloads/mutation-landscape-of-gi-tumors.pdf", plot = ., units = "in", height = 6, width = 20, device = cairo_pdf)
create_heatmap <- function(rate.df, gi_df, index){
code <- gi_df$rosetta[index]
cancer_name <- gi_df$names[index]
total_grid <- expand.grid(init_aa = agvgd::amino_acids("three_letter"), final_aa = agvgd::amino_acids("three_letter")) %>% as_tibble()
cancer.df <- rate.df %>% filter(rosetta == code)
mat <- total_grid %>% left_join(cancer.df) %>% mutate(rate = ifelse(is.na(rate), 0, rate))
mat$init_aa <- factor(mat$init_aa, levels = agvgd::amino_acids("three_letter") %>% sort())
mat$final_aa <- factor(mat$final_aa, levels = agvgd::amino_acids("three_letter") %>% sort() %>% rev())
plt <- mat %>% ggplot(., aes(x = init_aa, y = final_aa, fill = rate)) +  geom_tile() +  scale_fill_gradient(low = "lightgrey", high = "red", na.value = "lightgrey", breaks = scales::pretty_breaks(n = 6)) + labs(x = "Initial Amino Acid", y = "Final Amino Acid", fill = "Average #\nof Mutations") +  theme_minimal() + theme(panel.grid = element_blank()) + ggtitle(cancer_name) + theme(plot.title = element_text(size = 12, hjust = 0.5), axis.text = element_text(size = 6), axis.title = element_text(size = 9), legend.title = element_text(size = 10), legend.text = element_text(size = 8), legend.key.size = unit(0.25, "cm"))
if (!index %in% c(1, 5)){
plt <- plt + theme(legend.title = element_blank())
}
plt
}
plt.list <- lapply(1:nrow(gi_df), function(x) create_heatmap(rate.df, gi_df, x))
cowplot::plot_grid(plotlist = plt.list, nrow = 2, ncol = 4, rel_widths = c(1.08, 1, 1, 1)) %>% ggsave(filename = "~/Downloads/mutation-landscape-of-gi-tumors.pdf", plot = ., units = "in", height = 6, width = 20, device = cairo_pdf)
rate.df
rate.df %>% filter(rosetta %in% gi_df$rosetta)
rate.df %>% filter(rosetta %in% gi_df$rosetta) %>% select(init_aa, final_aa, rosetta, total) %>% distinct()
rate.df %>% filter(rosetta %in% gi_df$rosetta) %>% select(rosetta, total) %>% distinct()
rate.df %>% filter(rosetta %in% gi_df$rosetta) %>% select(rosetta, total) %>% distinct() %>% pull(total) %>% sum
